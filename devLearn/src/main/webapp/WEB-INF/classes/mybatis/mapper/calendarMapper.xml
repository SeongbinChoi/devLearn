<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cal">
	<insert id="insertCalendar" parameterType="com.sp.dev.mypage.Calendar">
		INSERT INTO planManagement (planNum, memberEmail, subject, planColor, 
				sDate, eDate, repeatCheck, repeatCycle, memo, regDate)
		VALUES (planManagement_seq.NEXTVAL, #{memberEmail}, #{subject}, #{planColor}, 
				TO_DATE(#{sDate},'YYYY/MM/DD'), TO_DATE(#{eDate},'YYYY/MM/DD'), 
				#{repeatCheck}, #{repeatCycle}, #{memo}, SYSDATE)
	</insert>

	<select id="listCalendar" parameterType="map" resultType="com.sp.dev.mypage.Calendar">
		SELECT planNum, m.memberEmail, subject, planColor, 
				sDate, eDate, repeatCheck, repeatCycle, memo, p.regDate
		FROM planManagement p
		JOIN member m ON m.memberEmail = p.memberEmail
		WHERE m.memberEmail = #{memberEmail}
	</select>
	
	<delete id="deleteCalendar" parameterType="map">
		DELETE FROM planManagement WHERE memberEmail = #{memberEmail} AND planNum = #{planNum}
	</delete>
	
	<update id="updateCalendar" parameterType="com.sp.dev.mypage.Calendar">
		UPDATE planManagement SET subject=#{subject}, planColor=#{planColor}, 
					sDate=#{sDate}, eDate=#{eDate}, repeatCheck=#{repeatCheck}, 
					repeatCycle=#{repeatCycle}, memo=#{memo}, regDate=#{regDate}
		WHERE planNum=#{planNum} AND memberEmail=#{memberEmail}
	</update>
</mapper>